import{_ as s,c as a,o as e,a4 as i}from"./chunks/framework.Bl20_RFa.js";const u=JSON.parse('{"title":"Project Configuration","description":"Learn how to configure a Terramate project. Terramate does not depend on user configuration and comes with a set of sensible defaults.","frontmatter":{"title":"Project Configuration","description":"Learn how to configure a Terramate project. Terramate does not depend on user configuration and comes with a set of sensible defaults."},"headers":[],"relativePath":"cli/projects/configuration.md","filePath":"cli/projects/configuration.md"}'),n={name:"cli/projects/configuration.md"},t=i(`<h1 id="project-configuration" tabindex="-1">Project Configuration <a class="header-anchor" href="#project-configuration" aria-label="Permalink to &quot;Project Configuration&quot;">​</a></h1><p>Any Git repository is considered to be a Terramate project. Additionally, Terramate does not depend on user configuration and comes with a set of sensible defaults that can be overwritten by adding a <code>terramate.tm.hcl</code> file at the root of your repository.</p><p>Configurations are valid project-wide and can be defined only once at the project root. All project configurations are defined within the <code>terramate</code> block.</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># terramate.tm.hcl</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # allow any Terramate v0.4.x version starting at v0.4.3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  required_version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;~&gt; 0.4.3&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # config options</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="the-terramate-required-version-attribute" tabindex="-1">The <code>terramate.required_version</code> attribute <a class="header-anchor" href="#the-terramate-required-version-attribute" aria-label="Permalink to &quot;The \`terramate.required_version\` attribute&quot;">​</a></h2><p>Required version is defined by the attribute <code>terramate.required_version</code> attribute where <code>required_version</code> accepts a version constraint string that specifies which versions of Terramate can be used inside a Terramate project.</p><p>The <code>terramate.required_version_allow_prereleases</code> attribute controls if <strong>prereleases</strong> should be matched according to <a href="https://semver.org/" target="_blank" rel="noreferrer">Semantic Versioning</a> precedence ordering. It&#39;s <strong>false</strong> by default and if set to <code>true</code>, then Terramate will also accept prereleases if they match the provided constraint.</p><blockquote><p>It is generally advised against modifying infrastructure code without possessing a comprehensive understanding of its function and impact. Ensure extreme caution when considering experimental releases, given that they can potentially lead to dangerous changes.</p></blockquote><p>We recommend pinning the exact version to use and updating the config when updating Terramate.</p><p>The version constraint string uses the same notation as the one used on <a href="https://www.terraform.io/language/expressions/version-constraints" target="_blank" rel="noreferrer">Terraform</a>.</p><p>Valid examples:</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # allow any Terramate v0.4.x version starting at v0.4.3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  required_version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;~&gt; 0.4.3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # allow any Terramate v0.4.x version starting at v0.4.3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  required_version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&gt;= 0.4.3, &lt; 0.5.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>If a <code>terramate.required_version</code> is not defined within a project, no versioning checks will be carried out. If a version constraint is specified and an incompatible version of Terramate is run, a fatal error will occur.</p><h2 id="the-terramate-config-block" tabindex="-1">The <code>terramate.config</code> block <a class="header-anchor" href="#the-terramate-config-block" aria-label="Permalink to &quot;The \`terramate.config\` block&quot;">​</a></h2><p>Project-wide configuration can be defined in this block. All possible settings are described in the following subsections.</p><h3 id="the-terramate-config-git-block" tabindex="-1">The <code>terramate.config.git</code> block <a class="header-anchor" href="#the-terramate-config-git-block" aria-label="Permalink to &quot;The \`terramate.config.git\` block&quot;">​</a></h3><p><a href="./../change-detection/integrations/git">Git integration</a> related configurations used in the <a href="./../change-detection/">Change Detection</a> and <a href="./../orchestration/safeguards">Safe Guards</a> are defined inside the <code>terramate.config.git</code> block, like this:</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    git</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Git configuration</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      default_remote</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;origin&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      default_branch</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;main&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # Safeguard</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_untracked</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Deprecated as of v0.4.5 (use terramate.config.disable_safeguards instead)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_uncommitted</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Deprecated as of v0.4.5 (use terramate.config.disable_safeguards instead)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_remote</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Deprecated as of v0.4.5 (use terramate.config.disable_safeguards instead)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="the-terramate-config-generate-block" tabindex="-1">The <code>terramate.config.generate</code> block <a class="header-anchor" href="#the-terramate-config-generate-block" aria-label="Permalink to &quot;The \`terramate.config.generate\` block&quot;">​</a></h3><p>The <code>terramate.config.generate</code> block can be used to configure the code generate feature. For now, only the <code>hcl_magic_header_comment_style</code> attribute is supported and it can be used to define which HCL comment style must be used by Terramate when generating HCL files. Example below:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>terramate {</span></span>
<span class="line"><span>  config {</span></span>
<span class="line"><span>    generate {</span></span>
<span class="line"><span>      hcl_magic_header_comment_style = &quot;#&quot;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span></code></pre></div><p>The config above will make Terramate generate files using <code>#</code> as comment style. The only valid options are <code>//</code> and <code>#</code>.</p><h3 id="the-terramate-config-run-block" tabindex="-1">The <code>terramate.config.run</code> Block <a class="header-anchor" href="#the-terramate-config-run-block" aria-label="Permalink to &quot;The \`terramate.config.run\` Block&quot;">​</a></h3><p>Configuration for the <code>terramate run</code> command can be set in the <code>terramate.config.run</code> block.</p><h4 id="disable-code-generation-check" tabindex="-1">Disable code generation check <a class="header-anchor" href="#disable-code-generation-check" aria-label="Permalink to &quot;Disable code generation check&quot;">​</a></h4><p>By default, <code>terramate run</code> will check that all generated code is up to date and throw an error if not:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ERR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> outdated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> code</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action=checkOutdatedGeneratedCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">filename=stg/ec2/_provider.tf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FTL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;terramate generate&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> code</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error=&quot;outdated generated code detected&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action=checkOutdatedGeneratedCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>If you want to disable this default safe-guard, you can set <code>check_gen_code = false</code> in the <code>terramate.config.run</code> block.</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_gen_code</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Deprecated as of v0.4.5 (use terramate.config.disable_safeguards instead)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>This check ensures that it&#39;s not possible to accidentally run against outdated code and we discourage disabling it.</p></div><h4 id="the-terramate-config-run-env-block" tabindex="-1">The <code>terramate.config.run.env</code> Block <a class="header-anchor" href="#the-terramate-config-run-env-block" aria-label="Permalink to &quot;The \`terramate.config.run.env\` Block&quot;">​</a></h4><p>In <code>terramate.config.run.env</code> block a map of environment variables can be defined that will be set when running a command using <code>terramate run</code>.</p><p>The following example exports the <code>TF_PLUGIN_CACHE_DIR</code> environment variable to enable <a href="https://www.terraform.io/cli/config/config-file#provider-plugin-cache" target="_blank" rel="noreferrer">Terraform Provider Plugin Caching</a>.</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        TF_PLUGIN_CACHE_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/some/path/etc&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Inside the <code>terramate.config.run.env</code> block the <code>env</code> namespace will be available including environment variables retrieved from the host:</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      env</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        TF_PLUGIN_CACHE_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">env</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/.terraform-cache-dir&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>In addition, Globals (<code>global.*</code>) and Metadata (<code>terramate.*</code>) are available and are evaluated lazy within the stack context the commands are executed in.</p><p>The <code>env</code> namespace is meant to give access to the host environment variables, it is read-only, and is only available when evaluating <code>terramate.config.run.env</code> blocks.</p><p>Any attributes defined on <code>terramate.config.run.env</code> blocks won&#39;t affect the <code>env</code> namespace.</p><p>You can have multiple <code>terramate.config.run.env</code> blocks defined on different files, but variable names <strong>cannot</strong> be defined twice.</p><h3 id="the-terramate-config-cloud-block" tabindex="-1">The <code>terramate.config.cloud</code> block <a class="header-anchor" href="#the-terramate-config-cloud-block" aria-label="Permalink to &quot;The \`terramate.config.cloud\` block&quot;">​</a></h3><p>Properties related to Terramate Cloud can be defined inside the <code>terramate.config.cloud</code> block. Currently, this block is only used to set the default cloud organization name:</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    cloud</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      organization</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;my-org-name&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Setting a cloud organization name is required when</p><ul><li>syncing with Terramate Cloud, i.e. by using <code>terramate run</code> with the <code>--cloud-sync-drift-status</code> or <code>--cloud-sync-deployment</code> options, and</li><li>the user is a member of more than one cloud organization.</li></ul><p>The specified name will be used to select which of the user&#39;s organizations to use in the scope of the project.</p><p>It&#39;s also possible to select a cloud organization by setting the environment variable <code>TM_CLOUD_ORGANIZATION</code> to the organization name. If set, the value from the environment variable will override the configuration setting.</p>`,48),l=[t];function r(h,o,p,c,d,k){return e(),a("div",null,l)}const E=s(n,[["render",r]]);export{u as __pageData,E as default};
