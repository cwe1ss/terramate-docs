import{_ as e,c as a,o as s,a4 as i}from"./chunks/framework.Bl20_RFa.js";const u=JSON.parse(`{"title":"Safeguards","description":"Learn about the various safeguards provided by Terramate CLI that help you ensure that the code you're running is exactly what you want.","frontmatter":{"title":"Safeguards","description":"Learn about the various safeguards provided by Terramate CLI that help you ensure that the code you're running is exactly what you want."},"headers":[],"relativePath":"cli/orchestration/safeguards.md","filePath":"cli/orchestration/safeguards.md"}`),t={name:"cli/orchestration/safeguards.md"},n=i(`<h1 id="safeguards" tabindex="-1">Safeguards <a class="header-anchor" href="#safeguards" aria-label="Permalink to &quot;Safeguards&quot;">​</a></h1><p>Terramate CLI has a number of safeguards when executing commands with <code>terramate run</code>, to ensure that the code you&#39;re running against is <em>exactly what you intended</em>.</p><h2 id="git-checks" tabindex="-1">Git checks <a class="header-anchor" href="#git-checks" aria-label="Permalink to &quot;Git checks&quot;">​</a></h2><p>The first set of checks ensures that your git status is clean:</p><ul><li>No files exist that are untracked (<code>check_untracked</code>)</li><li>No changes exist that are uncommitted (<code>check_uncommited</code>)</li><li>Local git is up to date with remote changes (<code>check_remote</code>)</li></ul><h2 id="code-generation-check" tabindex="-1">Code generation check <a class="header-anchor" href="#code-generation-check" aria-label="Permalink to &quot;Code generation check&quot;">​</a></h2><p>By default, <code>terramate run</code> will check that all generated code is up to date and throw an error if not:</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ERR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> outdated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> code</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action=checkOutdatedGeneratedCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">filename=stg/ec2/_provider.tf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">FTL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;terramate generate&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generated</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> code</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error=&quot;outdated generated code detected&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action=checkOutdatedGeneratedCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>This check ensures that it&#39;s not possible to accidentally run against outdated code and we <em>highly</em> discourage disabling it.</p><p>We also recommend using git hooks (e.g. <a href="https://pre-commit.com/" target="_blank" rel="noreferrer">pre-commit</a>) to ensure that <code>terramate generate</code> is run and the code is up to date <em>before</em> pushing your changes.</p><h2 id="disabling-checks" tabindex="-1">Disabling checks <a class="header-anchor" href="#disabling-checks" aria-label="Permalink to &quot;Disabling checks&quot;">​</a></h2><p>Safeguards are enabled per default and help you to keep your environment safe, but if required they <em>can</em> be disabled via CLI flags, environment variables or using the <a href="./../projects/configuration">project configuration</a>. Environment variables and CLI flags always take precedence over project config.</p><p>The <code>terramate.config.disable_safeguards</code> (added in v0.4.5) supports a list of check keywords to be disabled. Below is a list of supported values:</p><table><thead><tr><th>Check name</th><th>Description</th></tr></thead><tbody><tr><td>all</td><td>Disable all checks</td></tr><tr><td>git</td><td>Disable all git related checks</td></tr><tr><td>git-untracked</td><td>Disable the check for untracked files</td></tr><tr><td>git-uncommitted</td><td>Disable the check for uncommitted files</td></tr><tr><td>git-out-of-sync</td><td>Disable the check for git remote out of sync</td></tr><tr><td>outdated-code</td><td>Disable the check for outdated code</td></tr></tbody></table><p>The keywords above can be used together in the environment variable <code>TM_DISABLE_SAFEGUARDS</code>, in the <code>terramate.config.disable_safeguards</code> or provided in the command line in the <code>--disable-safeguards=&lt;options&gt;</code>. Examples:</p><p>Using environment variable:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>TM_DISABLE_SAFEGUARDS=git-untracked,git-uncommitted terramate run -- &lt;cmd&gt;</span></span></code></pre></div><p>Using cli flag:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>terramate run --disable-safeguards=git-untracked,git-uncommitted -- &lt;cmd&gt;</span></span></code></pre></div><p>Using the configuration file:</p><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># terramate.tm</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    disable_safeguards</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;git-untracked&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;git-uncommitted&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="deprecated-config-and-environment-variables" tabindex="-1">Deprecated config and environment variables <a class="header-anchor" href="#deprecated-config-and-environment-variables" aria-label="Permalink to &quot;Deprecated config and environment variables&quot;">​</a></h3><p>The list of attributes and correspondent environment variable listed below are deprecated (from v0.4.5 onwards) and will be removed in future versions of Terramate.</p><table><thead><tr><th>Project configuration setting</th><th>Environment variable</th></tr></thead><tbody><tr><td><code>terramate.config.git.check_remote = false</code></td><td><code>TM_DISABLE_CHECK_GIT_REMOTE=true</code></td></tr><tr><td><code>terramate.config.git.check_untracked = false</code></td><td><code>TM_DISABLE_CHECK_GIT_UNTRACKED=true</code></td></tr><tr><td><code>terramate.config.git.check_uncommitted = false</code></td><td><code>TM_DISABLE_CHECK_GIT_UNCOMMITTED=true</code></td></tr><tr><td><code>terramate.config.run.check_gen_code = false</code></td><td><code>TM_DISABLE_CHECK_GEN_CODE=true</code></td></tr></tbody></table><h4 id="example-of-a-project-config-disabling-all-checks" tabindex="-1">Example of a project config disabling all checks <a class="header-anchor" href="#example-of-a-project-config-disabling-all-checks" aria-label="Permalink to &quot;Example of a project config disabling all checks&quot;">​</a></h4><div class="language-hcl vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">hcl</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># terramate.tm.hcl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">terramate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_gen_code</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    git</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_remote</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_untracked</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      check_uncommitted</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,26),d=[n];function r(l,h,c,o,p,k){return s(),a("div",null,d)}const E=e(t,[["render",r]]);export{u as __pageData,E as default};
